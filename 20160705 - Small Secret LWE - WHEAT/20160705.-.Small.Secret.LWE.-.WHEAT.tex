% Created 2016-10-14 Fri 13:12
\documentclass[presentation,smaller]{beamer}
\RequirePackage{etex}
\RequirePackage[l2tabu,orthodox]{nag}            %% Warn about obsolete commands and packages
\RequirePackage{amsmath,amsfonts,amssymb,amsthm} %% Math
\RequirePackage{ifxetex,ifluatex}                %% Detect XeTeX and LuaTeX
\RequirePackage{fixltx2e}                        %% provides \textsubscript
\RequirePackage{xspace}
\RequirePackage{graphicx}
\RequirePackage{comment}
\RequirePackage{url}
\RequirePackage{relsize}
\RequirePackage{booktabs}
\RequirePackage{tabularx}
\RequirePackage[normalem]{ulem}
\RequirePackage[all]{xy}

%%%
%%% Code Listings
%%%

\RequirePackage{listings}
\lstdefinelanguage{Sage}[]{Python}{morekeywords={True,False,sage,cdef,cpdef,ctypedef,self},sensitive=true}

\lstset{frame=none,
  showtabs=False,
  showspaces=False,
  showstringspaces=False,
  commentstyle={\color{gray}},
  keywordstyle={\color{mLightBrown}\textbf},
  stringstyle ={\color{mDarkBrown}},
  frame=single,
  basicstyle=\tt\scriptsize\relax,
  backgroundcolor=\color{gray!190!black},
  inputencoding=utf8,
  literate={…}{{\ldots}}1,
  belowskip=0.0em,
}

%%%
%%% Tikz
%%%

\RequirePackage{tikz,pgfplots}

\usetikzlibrary{calc}
\usetikzlibrary{arrows}
\usetikzlibrary{automata}
\usetikzlibrary{positioning}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{backgrounds}
\usetikzlibrary{fit,}
\usetikzlibrary{shapes.symbols}
\usetikzlibrary{chains}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{shapes.arrows}
\usetikzlibrary{graphs}

%% Cache

\ifdefined\tikzcaching  % chktex 1
  \usetikzlibrary{external}
  \tikzexternalize[prefix=build/]
  \tikzset{external/up to date check=diff}  %% MD5 fails from within emacs
\fi

%%%
%%% SVG (Inkscape)
%%%

\ifxetex % chktex 1
\newcommand{\executeiffilenewer}[3]{%
  {\immediate\write18{#3}} % hack
}
\else
\newcommand{\executeiffilenewer}[3]{%
  \ifnum\pdfstrcmp{\pdffilemoddate{#1}}%
    {\pdffilemoddate{#2}}>0%
    {\immediate\write18{#3}}
  \fi%
}
\fi

\newcommand{\includesvg}[2][1.0\textwidth]{%
 \executeiffilenewer{#1.svg}{#1.pdf}%
 {inkscape -z -D --file=#2.svg --export-pdf=#2.pdf --export-latex --export-area-page}%
 \def\svgwidth{#1} 
 \input{#2.pdf_tex}%
} 

%%%
%%% Metropolis Theme
%%%

\usetheme{metropolis}
\metroset{color/block=fill}
\metroset{numbering=none}
\metroset{outer/progressbar=foot}
\metroset{titleformat=smallcaps}

\setbeamercolor{description item}{fg=mLightBrown}
% \setbeamerfont{alerted text}{series=\bfseries}
\setbeamerfont{footnote}{size=\scriptsize}
\setbeamercolor{example text}{fg=mDarkBrown}

\renewcommand*{\UrlFont}{\ttfamily\smaller\relax}

%%%
%%% UTF-8
%%% 

\RequirePackage{unicodesymbols} % after metropolis which loads fontspec

%%%
%%% BibLaTeX
%%%

\RequirePackage[backend=bibtex,
            style=alphabetic,
            maxnames=4,
            citestyle=alphabetic]{biblatex}

\bibliography{local.bib,abbrev3.bib,crypto_crossref.bib,rfc.bib,jacm.bib}

\DeclareFieldFormat{title}{\alert{#1}}
\DeclareFieldFormat[book]{title}{\alert{#1}}
\DeclareFieldFormat[thesis]{title}{\alert{#1}}
\DeclareFieldFormat[inproceedings]{title}{\alert{#1}}
\DeclareFieldFormat[incollection]{title}{\alert{#1}}
\DeclareFieldFormat[article]{title}{\alert{#1}}
\DeclareFieldFormat[misc]{title}{\alert{#1}}

%%% 
%%% Microtype
%%%

\IfFileExists{upquote.sty}{\RequirePackage{upquote}}{}
\IfFileExists{microtype.sty}{\RequirePackage{microtype}}{}

\setlength{\parindent}{0pt}                   %%
\setlength{\parskip}{6pt plus 2pt minus 1pt}  %%
\setlength{\emergencystretch}{3em}            %% prevent overfull lines
\setcounter{secnumdepth}{0}                   %%

%%% Local Variables:
%%% mode: latex
%%% End:
\usepackage{fixltx2e}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage[color=FFDD00]{todonotes}
\usepackage{microtype}
\usepackage{newunicodechar}
\usepackage{unicodesymbols}
\usepackage[notions,operators,sets,keys,ff,adversary,primitives,complexity,asymptotics,lambda]{cryptocode}
\usepackage{xspace}
\usepackage{units}
\usepackage{nicefrac}
\usepackage{gensymb}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{xcolor}
\usepackage{listings}
\newcommand{\ZZ}[1][blank]{\ensuremath{\ifthenelse{\equal{#1}{blank}}{\mathbb{Z}}{\mathbb{Z}\left[#1\right]}\xspace}}
\newcommand{\QQ}[1][blank]{\ensuremath{\ifthenelse{\equal{#1}{blank}}{\mathbb{Q}}{\mathbb{Q}\left[#1\right]}\xspace}}
\newcommand{\ZZq}[1][blank]{\ensuremath{\ifthenelse{\equal{#1}{blank}}{\mathbb{Z}_q}{\mathbb{Z}_q\left[#1\right]}\xspace}}
\usepackage{filecontents}
\renewcommand{\U}[1]{\ensuremath{\mathcal{U}\left( {#1} \right)}\xspace}
\newcommand{\mat}[1]{\ensuremath{\mathbf{#1}}\xspace}
\renewcommand{\vec}[1]{\ensuremath{\mathbf{#1}}\xspace}
\newcommand{\shortvec}[1]{\tilde{\mathbf{#1}}\xspace}
\newcommand{\sample}{\ensuremath{\leftarrow_{\$}}}
\newcommand{\ovec}[1]{\ensuremath{\overline{\vec{#1}}}\xspace}
\newcommand{\Id}[1][n]{\ensuremath{\mat{I}_{#1}}\xspace}
\newcommand{\Ze}[1][n \times n]{\ensuremath{\mat{0}_{#1}}\xspace}
\renewcommand{\B}[2][]{\ensuremath{\mathcal{B}_{#1}^{#2}}\xspace}
\newcommand{\ip}[2]{\ensuremath{\left\langle {#1},{#2}\right\rangle}\xspace}
\definecolor{lightblue}{HTML}{4B8EC8}
\definecolor{butter1}{rgb}{0.988,0.914,0.310}
\definecolor{chocolate1}{rgb}{0.914,0.725,0.431}
\definecolor{chameleon1}{rgb}{0.541,0.886,0.204}
\definecolor{skyblue1}{rgb}{0.447,0.624,0.812}
\definecolor{plum1}{rgb}{0.678,0.498,0.659}
\definecolor{scarletred1}{rgb}{0.937,0.161,0.161}
\setbeamercolor{example text}{fg=mDarkBrown}
\newcommand{\pq}{\ensuremath{\frac{p}{q}}}
\newcommand{\round}[1]{\ensuremath{\left\lfloor{#1}\right\rceil}\xspace}
\newcommand{\Ldis}{L_{\vec{s},\chi}^{(n)}\xspace}
\newcommand{\Q}[1][⋅]{\ensuremath{\mathcal{Q}_{\vec{s}}\left( {#1} \right)}\xspace}
\usetheme{default}
\author{Martin R. Albrecht}
\date{07/05/2016}
\title{Some Remarks on Small Secret LWE}
\subtitle{Another Look at HELib’s Choices of Parameters}
\hypersetup{
pdfauthor={Martin R. Albrecht},
pdftitle={Some Remarks on Small Secret LWE},
pdfkeywords={},
pdfsubject={},
pdfcreator={Emacs 24.5.1 (Org mode 8.3.6)},
pdflang={English},
colorlinks,
citecolor=gray,
filecolor=gray,
linkcolor=gray,
urlcolor=gray
}
\begin{document}

\maketitle
\begin{frame}{Outline}
\tableofcontents
\end{frame}


\section{Introduction}
\label{sec:orgheadline11}
\begin{frame}[label={sec:orgheadline1}]{Learning with Errors}
The Learning with Errors (LWE) problem was deﬁned by Oded Regev.\footfullcite{STOC:Regev05}

Given \((\vec{A},\vec{c})\) with \(\vec{c} \in \ZZq^{m}\), \(\vec{A} \in \ZZq^{m × n}\), \(\vec{s} \in \ZZq^{n}\) and small \(\vec{e} \in \ZZ^{m}\) is

\[
\left(\begin{array}{c}
\\
\\
\\ 
\vec{c} \\
\\
\\
\\
\end{array} \right) = \left(
\begin{array}{ccc}
\leftarrow & n & \rightarrow \\
\\
\\ 
& \vec{A} & \\
\\
\\
\\
\end{array} \right) \cdot \left( \begin{array}{c}
\\
\vec{s} \\
\\
\end{array} \right) + \left(
\begin{array}{c}
\\
\\
\\ 
\vec{e} \\
\\
\\
\\
\end{array} 
\right)
\]

or \(\vec{c} \sample \U{\ZZq^{m}}\).
\end{frame}

\begin{frame}[label={sec:orgheadline2}]{Parameters}
\begin{columns}
\begin{column}{0.5\columnwidth}
\begin{tikzpicture}[scale=0.7]
  \begin{axis}[
    domain=-10:10,
    grid=major,smooth,
    xlabel=$x$,
    ylabel=$\approx \textnormal{Pr}(x)$,
    ]
    \addplot[color=chocolate1,very thick,samples=50,smooth]{exp(-(x^2)/18)};
    \addplot[only marks,color=lightblue] coordinates {
      (-9, 0.011)
      (-8, 0.028)
      (-7, 0.065)
      (-6, 0.135)
      (-5, 0.249)
      (-4, 0.411)
      (-3, 0.606)
      (-2, 0.800)
      (-1, 0.945)
      (0, 1.000)
      (1, 0.945)
      (2, 0.800)
      (3, 0.606)
      (4, 0.411)
      (5, 0.249)
      (6, 0.135)
      (7, 0.065)
      (8, 0.028)
      (9, 0.011)
    };
  \end{axis}
\end{tikzpicture}
\end{column}


\begin{column}{0.5\columnwidth}
\begin{itemize}
\item Parameters are: 
\begin{itemize}
\item dimension \(n\),
\item modulus \(q\) (e.g. \(q \approx n^2\)),
\item noise size \(\alpha\) (e.g. \(\alpha q \approx \sqrt{n}\)),
\item number of samples \(m\).
\end{itemize}

\item Elements of \(\vec{A}, \vec{s}, \vec{e}, \vec{c}\) are in \(\ZZ_q\).
\item \(\vec{e}\) is sampled from \(χ_{α}\), a discrete Gaussian with width \[\sigma=\frac{\alpha q}{\sqrt{2 \pi}}.\]
\end{itemize}
\end{column}
\end{columns}
\end{frame}

\begin{frame}[label={sec:orgheadline3}]{FHE-schemes based on LWE}
\footnotesize

\begin{description}
\item[{BGV}] \fullcite{ITCS:BraGenVai12}
\item[{FV}] \fullcite{EPRINT:FanVer12}
\item[{LTV}] \fullcite{STOC:LopTroVai12} \footnote{See Léo’s talk for attacks on LTV and YASHE exploiting that they are not quite LWE.}
\item[{YASHE}] \fullcite{IMA:BLLN13}
\end{description}
\end{frame}

\begin{frame}[label={sec:orgheadline4}]{FHE-schemes based on LWE (cont.)}
\footnotesize

\begin{description}
\item[{GSW}] \fullcite{C:GenSahWat13}

\item[{AGCD}] \fullcite{EC:CheSte15}
\end{description}
\end{frame}

\begin{frame}[fragile,label={sec:orgheadline5}]{Small Secrets}
 \begin{itemize}
\item FHE schemes based on LWE typically choose very small secrets.
\item For example, \(\vec{s}_{i} ← \{-1,0,1\}\) or \(\vec{s_{i}} ← \{0,1\}\).
\item \texttt{HElib} \footfullcite{C:HalSho14} typically chooses \(\vec{s}\) such that \(w=64\) entries are \(±1\) and all remaining entries are \(0\), regardless of dimension \(n\).
\item The same strategy is used in a recent comparison study.\footfullcite{RSA:CosSma16}
\end{itemize}

\begin{center}
\alert{How many bits of security does this cost?}
\end{center}
\end{frame}

\begin{frame}[label={sec:orgheadline6}]{Binary LWE Secret Distributions}
\begin{description}
\item[{\(\B{+}\)}] each component is independently sampled uniformly from \(\{0,1\}\).
\item[{\(\B{-}\)}] each component is independently sampled uniformly from \(\{-1,0,1\}\).
\item[{\(\B[h]{±}\)}] like above but with guarantee that \(h\) components are non-zero.
\end{description}
\end{frame}

\begin{frame}[label={sec:orgheadline7}]{Hardness: LWE Normal Form}
Given samples
\[(\vec{a},c)=(\vec{a},\langle\vec{a},\alert{\vec{s}}\rangle+ e) \in \ZZq^n × \ZZq\]
with \(\vec{a} \gets \mathcal{U}(\ZZq^n)\), \(e \gets D_{α q,0}\) and \(\vec{s} \in \ZZq^n\),
we can construct samples
\[(\vec{a}, c)=(\vec{a},⟨\vec{a},\alert{\vec{e}}⟩+ e) \in \ZZq^n × \ZZq\] with
\(\vec{a} ← \mathcal{U}(\ZZq^n)\), \(e ← D_{α q, 0}\) and \alert{\(\vec{e}\)} such that all components \alert{\[e_i ← D_{α q, 0}\]} in polynomial time.\footfullcite{C:ACPS09}
\end{frame}

\begin{frame}[label={sec:orgheadline8}]{Hardness: Reductions}
\begin{quote}
“A major part of our reduction [\dots{}] is therefore dedicated to showing  reduction from LWE (in dimension \(n\)) with arbitrary secret in \(\ZZq^n\) to LWE (in dimension \alert{\(n \log_2 q\)}) with a secret chosen uniformly over \(\{0, 1\}\).” \footfullcite{STOC:BLPRS13}
\end{quote}
\end{frame}

\begin{frame}[label={sec:orgheadline9}]{Hardness: Algorithms}
\begin{quote}
“[This work] suggests that this is overkill and that even \alert{\(n\log\log n\)} may be more than sufficient.”\footfullcite{ACISP:BaiGal14}
\end{quote}
\end{frame}

\begin{frame}[label={sec:orgheadline10}]{Hardness: Constructions}
\begin{quote}
“This brings up the question of whether one can get better attacks against LWE instances with a very sparse secret (much smaller than even the noise). [\dots{}] it seems that the very sparse secret should only add maybe \alert{one bit to the modulus/noise ratio}.” \footfullcite{EPRINT:GenHalSma12}
\end{quote}
\end{frame}

\section{Base Line}
\label{sec:orgheadline25}
\begin{frame}[label={sec:orgheadline12}]{Dual Attack}
\begin{block}{Short Integer Solutions (SIS)}
Given \(q \in \ZZ\), a matrix \(\vec{A}\), and \(t < q\); find \(\vec{y}\) with \(0 < \| \vec{y} \| \leq t\) and \[\vec{y} ⋅ \vec{A} ≡ \vec{0} \pmod{q}.\]
\end{block}

\begin{itemize}
\item Find a short \(\vec{y}\) solving SIS on \(\vec{A}\).
\item Given LWE samples \(\vec{A}, \vec{c}\) where \(\vec{c} = \vec{A}⋅\vec{s} + \vec{e}\) or \(\vec{c}\) uniform.
\item Compute \(\ip{\vec{y}}{\vec{c}}\).
\begin{itemize}
\item If \(\vec{c} = \vec{A}⋅\vec{s} + \vec{e}\), then \(\ip{\vec{y}}{\vec{c}} = \ip{\vec{y}⋅\vec{A}}{\vec{s}} + \ip{\vec{y}}{\vec{e}} \equiv \ip{\vec{y}}{\vec{e}} \pmod{q}\).
\item If \(\vec{c}\) is uniformly random, so is \(\ip{\vec{y}}{\vec{c}}\).
\end{itemize}
\item If \(\vec{y}\) is short then \(\ip{\vec{y}}{\vec{e}}\) is also short.
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline13}]{Dual Attack}
\begin{lemma}
Given an LWE instance characterised by \(n\), \(α\), \(q\) and a vector \(\vec{v}\) of length \(\|\vec{v}\|\) such that \(\vec{v} ⋅ \vec{A} \equiv 0 \pmod{q}\), the advantage of distinguishing \(\ip{\vec{v}}{\vec{e}}\) from random is close to \footfullcite{RSA:LinPei11} \[\exp(-π(\|\vec{v}\| ⋅ α)^2).\]
\end{lemma}
\end{frame}

\begin{frame}[label={sec:orgheadline14}]{Dual Attack}
A \alert{reduced lattice} basis contains short vectors. In particular, the first vector is short: \(\|\vec{v}\| ≈ δ_0^m\, q^{n/m}\).

\begin{enumerate}
\item Construct a basis of the dual lattice from \(\vec{A}\).
\item Run lattice reduction algorithm to obtain short vectors \(\vec{v}_i\).
\item Check if \(\vec{v}_i⋅ \vec{A}\) are small.\footfullcite{PQCBook:MicReg09}
\end{enumerate}

\begin{block}<2->{Cost}
How expensive is it to achieve the target quality?
\end{block}
\end{frame}

\begin{frame}[fragile,label={sec:orgheadline15}]{HELib}
 \lstset{language=C++,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
long FindM(long k, long L, long c, long p, long d, long s,
           long chosen_m, bool verbose) {
  // get a lower-bound on the parameter N=phi(m):
  …
  // 6. To get k-bit security we need N>log(Q0/sigma)(k+110)/7.2, i.e.
  //    roughly N > (L+1)*pSize*(1+1/c)(k+110) / 7.2

  // Compute a bound on m, and make sure that it is not too large
  double cc = 1.0+(1.0/(double)c);
  double dN = ceil((L+1)*FHE_pSize*cc*(k+110)/7.2);
  …
  return m;
}
\end{lstlisting}
\end{frame}

\begin{frame}[label={sec:orgheadline16}]{Lindner-Peikert Estimates}
Lindner and Peikert \footfullcite{RSA:LinPei11} give an estimate for the runtime (in seconds) of BKZ as \[\log{t_{BKZ}(δ_0)} = \frac{1.8}{\log{δ_0}}-110\] based on experiments with BKZ in the NTL library.
\end{frame}

\begin{frame}[label={sec:orgheadline17}]{Lindner-Peikert Estimates}
\begin{itemize}
\item The LP model does not fit the implementation of BKZ in NTL.

\item NTL does not implement preprocessing of local blocks with BKZ recursively.\footnote{See Damien’s talk on lattice reduction (and fplll’s implementation).}

\item Hence, its enumeration requires \(2^{Ω(k^2)}\) time in block size \(k\).
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline18}]{Lindner-Peikert Estimates}
The LP model assumes a linear relation between \(1/k\) and \(\log(δ_0)\), but from the “lattice rule-of-thumb” (\(δ_0 ≈ k^{1/(2k)}\)) we get \footfullcite{JMC:AlbPlaSco15}

\begin{lemma}
The log of the time complexity achieve a root-Hermite factor \(δ_0\) with BKZ is
\[Ω \left( \frac{\log(1/\log δ_0)}{\log δ_0} \right)\]
if calling the SVP oracle costs \(2^{Ω(k)}\).
\end{lemma}
\end{frame}

\begin{frame}[label={sec:orgheadline19}]{LP = A Subexponential Attack on Regev’s LWE}
\begin{lemma}
Given an LWE instance parametrised by \(n\), \(q=n^c\), \(αq = \sqrt{n}\). A lattice reduction algorithm achieving log root-Hermite factor
\[\log δ_0 = {\frac{\left(\left(c-\frac{1}{2} \right) \log{n} + \log{\sqrt{\ln(1/ε)/π}} \right)^2}{4cn \log{n}} }\] can be used to distinguish the LWE distribution with advantage \(ε\).\footfullcite{JMC:AlbPlaSco15}
\end{lemma}

Picking \(\log{\sqrt{\ln(1/ε)/π}} ≈ 1\) and \(c=2\) we gets 

\[\log δ_0 = \frac{9\, \log n }{32\,n} \textnormal{ and } \log \left(t_{BKZ}(δ_0)\right) = \frac{32\, n}{5\, \log n }-110.\]
\end{frame}

\begin{frame}[label={sec:orgheadline20}]{BKZ 2.0 Based Guestimates}
We’ll assume \footfullcite{PhD:Chen13,C:Laarhoven15,C:HanPujSte11}

\begin{itemize}
\item \(δ_0 ≈ {\left( \frac{k}{2 \pi e} {(π k)}^{\frac{1}{k}}  \right)}^{\frac{1}{2(k-1)}}\)
\item sieving is used as the SVP oracle in dimension \(k\)
\item sieving in blocksize \(k\) costs \(t_k = 2^{0.3366\,k + 12.31}\) clock cycles
\item BKZ-\(k\) costs \(\frac{n^3}{k^2} \log(n) \cdot t_k\) cycles
\end{itemize}

\begin{block}{Samples}
We will also assume access to as many samples as needed.
\end{block}
\end{frame}

\begin{frame}[label={sec:orgheadline21}]{Comparison}
\includegraphics[width=1.0\textwidth]{lp_vs_sieve.png}
\end{frame}


\begin{frame}[fragile,label={sec:orgheadline22}]{Rolling Example}
 We use the following LWE parameters as a rolling example throughout this talk.

\begin{itemize}
\item dimension \(n=2048\),
\item modulus \(q ≈ 2^{63.4}\),
\item noise parameter \(\alpha ≈ 2^{-60.4}\), i.e. standard deviation \(σ ≈ 3.2\),
\item \(h=64\) components of the secret are \(\pm 1\), all other components are zero, \(σ_s ≈ 0.44\): \(\B[64]{-}\)
\end{itemize}

This is inspired by parameters choices in \texttt{HElib}.
\end{frame}

\begin{frame}[label={sec:orgheadline23}]{Lattice Attacks}
\begin{description}
\item[{Dual Attack}] solve Short Integer Solutions problem (SIS) in the left kernel of \(\vec{A}\), i.e.
\[
  \textnormal{ find a short } \vec{w} \textnormal{ such that } \vec{w} ⋅ \vec{A} = 0
  \]
and check if \(\ip{\vec{w}}{\vec{c}} = \vec{w}⋅ \left(\vec{A} ⋅ \vec{s} + \vec{e}\right) = \ip{\vec{w}}{\vec{e}}\) is short.

\item[{Primal Attack}] solve Bounded Distance Decoding problem (BDD), i.e.
\[
  \textnormal{ find } \vec{s'} \textnormal{ s.t. } \|\vec{w} - \vec{c}\| \textnormal{ with } \vec{w} = \vec{A} ⋅ \vec{s'} \textnormal{ is minimised}
  \]
using 
\begin{itemize}
\item Kannan's embedding or

\item Babai's nearest planes (Decoding).
\end{itemize}
\end{description}
\end{frame}

\begin{frame}[label={sec:orgheadline24}]{Base Line}
\begin{center}
\begin{tikzpicture}[scale=0.95]
  \begin{axis}[
    legend pos=outer north east,
    axis lines=middle,
    xmin=0.5, xmax=3.5,
    ymin=80, ymax=190,
    axis y line*=left,
    axis x line*=bottom,
    xticklabels={Dual, Decode, Kannan},
    xtick={1,...,3},
    ytick={100, 137.4, 174.6, 200},
    x tick label style={rotate=45,anchor=east},
    legend columns=1,
    legend cell align=left,]
    \addplot [only marks,color=skyblue1] table [x=idx,y=base/sieve,col sep=comma] {times.csv};
    \addplot [only marks,color=chocolate1,] table [x=idx,y=base/lp,col sep=comma] {times.csv};
    \legend{sieving,lp}\;
    \addplot[color=lightgray,table/row sep=\\] table {
      0.5 137.4\\
      3.5 137.4\\
    };
    \addplot[color=lightgray,table/row sep=\\] table {
      0.5 174.6\\
      3.5 174.6\\
    };

  \end{axis}
\end{tikzpicture}
\end{center}
\end{frame}

\section{Swapping Error and Secret}
\label{sec:orgheadline30}
\begin{frame}[label={sec:orgheadline26}]{Swapping Error and Secret}
\begin{quote}
“applying the reduction technique of Applebaum et al.\footfullcite{C:ACPS09} to switch the key with part of the error vector, thus getting a smaller LWE error.”\footfullcite{EPRINT:GenHalSma12}
\end{quote}
\end{frame}

\begin{frame}[label={sec:orgheadline27}]{Swapping Error and Secret}
\begin{itemize}
\item Let \(\vec{A}_0\) denotes the first \(n\) rows of \(\vec{A}\), \(\vec{A}_1\) the next \(n\) rows, etc.

\item \(\vec{e}_0, \vec{e}_1, \dots\) are the corresponding parts of the error vector and

\item \(\vec{c}_0 , \vec{c}_1, \dots\) the corresponding parts of \(\vec{c}\).

\item For \(i=0\) we have \(\vec{c}_0 = \vec{A}_0 \cdot \vec{s}  + \vec{e}_0\) or \[\vec{A}_0^{-1} \cdot \vec{c}_0 = \vec{s} + \vec{A}_0^{-1} \vec{e}_0.\]

\item For \(i > 0\) we have \(\vec{c}_i = \vec{A}_i \cdot \vec{s} + \vec{e}_i\), which together with the above gives \[\vec{A}_i ⋅ \vec{A}_0^{-1} ⋅ \vec{c}_0 - \vec{c}_i = \vec{A}_i ⋅ (\vec{s} + \vec{A}_0^{-1} \vec{e}_0) - \vec{c}_i =  \vec{A}_i ⋅ \vec{A}_0^{-1} \vec{e}_0 - \vec{e}_i.\]
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline28}]{Bai-Gal Algorithm}
\begin{itemize}
\item Consider the lattice
\[Λ=\{\vec{v} \in \ZZ^{n+m} | (\vec{A} | \vec{I}_m ) ⋅ \vec{v} ≡ 0 \pmod{q} \}\]
\item It has an unusually short vector \((\vec{s} || \vec{e})\).
\item When \(\|\vec{s}\| \ll \|\vec{e}\|\), the vector \((\vec{s} || \vec{e})\) is uneven in length.
\item Rescale the first part to have the same norm as the second.\footfullcite{ACISP:BaiGal14} \pause
\begin{itemize}
\item When \(\vec{s} \sample \B{-}\), the volume of the lattice is scaled by \(\sigma^n\).
\item When \(\vec{s} \sample \B{+}\) the volume of the lattice is scaled by \({(2\sigma)}^n\) because we can scale by \(2\sigma\) and then rebalance.
\item When \(\vec{s} \sample \B[hw]{±}\) the volume is scaled depending on the \(hw\).
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline29}]{Swapping Error and Secret: Sieving}
\begin{center}
\begin{tikzpicture}[scale=0.95]
  \begin{axis}[
    legend pos=outer north east,
    axis lines=middle,
    xmin=0.5, xmax=3.5,
    ymin=80, ymax=160,
    axis y line*=left,
    axis x line*=bottom,
    xticklabels={Dual, Decode, Embed},
    xtick={1,...,3},
    ytick={100, 134.8, 150},
    x tick label style={rotate=45,anchor=east},
    legend columns=1,
    legend cell align=left,]
    \addplot [only marks,color=skyblue1!40!white] table [x=idx,y=base/sieve,col sep=comma] {times.csv};
    \addplot [only marks,color=skyblue1]  table [x=idx,y=sec/sieve,col sep=comma] {times.csv};
    \legend{no swap, swap}\;
    \addplot[color=lightgray,table/row sep=\\] table {
      0.5 134.8\\
      3.5 134.8\\
    };

  \end{axis}
\end{tikzpicture}

For our rolling example this reduces \(α\) from \(2^{-60.4}\) to \(≈2^{-60.8}\)
\end{center}
\end{frame}

\section{Modulus Switching}
\label{sec:orgheadline46}
\begin{frame}[label={sec:orgheadline31}]{Modulus Switching}
\begin{lemma}
Let \((\vec{a},c) =(\vec{a}, \ip{\vec{a}}{\vec{s}} + e) \in \ZZq^n × \ZZq\) be an LWE sample and \[p ≈ \sqrt{\frac{2π\, n}{12}} ⋅ \frac{σ_s}{α},\] where \(σ_s\) is the standard deviation of components of \(\vec{s}\). If \(p<q\) then \[\bigg(\round{\frac{p}{q} ⋅ \vec{a}}, \round{\frac{p}{q} ⋅  c}\bigg) \textnormal{ in } \ZZ_{p}^n × \ZZ_{p}\] follows a distribution close to an LWE distribution with \(n, \sqrt{2}\,α, p\).\footfullcite{FOCS:BraVai11}
\end{lemma}
\end{frame}

\begin{frame}[label={sec:orgheadline32}]{Modulus Switching in Cryptanalysis}
When the secret is much smaller than the noise, applying modulus switching produces an easier LWE problem.
\end{frame}

\begin{frame}[label={sec:orgheadline33}]{Modulus Switching: Sieving}
\begin{center}
\begin{tikzpicture}[scale=0.95]
  \begin{axis}[
    legend pos=outer north east,
    axis lines=middle,
    xmin=0.5, xmax=3.5,
    ymin=120, ymax=150,
    axis y line*=left,
    axis x line*=bottom,
    xticklabels={Dual, Decode, Embed},
    xtick={1,...,3},
    ytick={120, 137.4, 150},
    x tick label style={rotate=45,anchor=east},
    legend columns=1,
    legend cell align=left,]
    \addplot [only marks,color=skyblue1!40!white] table [x=idx,y=base/sieve,col sep=comma] {times.csv};
    \addplot [only marks,color=skyblue1] table [x=idx,y=mod/sieve,col sep=comma] {times.csv};
    \legend{base line, mod switch}\;
    \addplot[color=lightgray,table/row sep=\\] table {
      0.5 137.4\\
      3.5 137.4\\
    };
  \end{axis}
\end{tikzpicture}
\end{center}
\end{frame}

\begin{frame}[label={sec:orgheadline34}]{Modulus Switching in Combinatorial Dual Attack}
\begin{itemize}
\item BKW can seen as a combinatorial version of the Dual Attack.
\item It was originally proposed for Learning Parity with Noise (LPN) which can be viewed as a special case of LWE over \(\ZZ_{2}\).
\item For BKW, variants of modulus switching lead to big performance gains.
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline35}]{BKW Algorithm}
Assume \((\vec{a}_{21},\vec{a}_{22}) = (0, 1)\), then:

\footnotesize
\begin{align*}
   & \left(
      \begin{array}{rr|rrr|r}
        \phantom{xn}\vec{a}_{11}         & \phantom{xn}\vec{a}_{12}         & \vec{a}_{13} & \cdots & \vec{a}_{1n} & c_1\\
        \alert{\vec{a}_{21}} & \alert{\vec{a}_{22}} & \vec{a}_{23} & \cdots & \vec{a}_{2n} & c_2\\
        \vdots               & \vdots               & \ddots       & \vdots & \vdots\\
        \vec{a}_{m1}         & \vec{a}_{m2}         & \vec{a}_{m3} & \cdots & \vec{a}_{mn} & c_{m}
      \end{array}
                                                                               \right)\\
  -& \left[
      \begin{array}{rr|rrr|r}
        0         & 0         & \vec{t}_{13}   & \cdots & \vec{t}_{1n}   & c_{t,1}\\
        \alert{0} & \alert{1} & \vec{t}_{23}   & \cdots & \vec{t}_{2n}   & c_{t,2}\\
        \vdots    & \vdots    & \ddots         & \vdots & \vdots\\
        q-1       & q-1       & \vec{t}_{q^23} & \cdots & \vec{t}_{q^2n} & c_{t,q^2}
        \end{array}\right]\\
   \Rightarrow &
     \left(\begin{array}{rr|rrr|r}
             \phantom{xn}\vec{a}_{11} & \phantom{xn}\vec{a}_{12} & \vec{a}_{13}      & \cdots & \vec{a}_{1n}      & \tilde{c}_1\\
             \alert{0}    & \alert{0}    & \shortvec{a}_{23} & \cdots & \shortvec{a}_{2n} & \tilde{c}_2\\
             \vdots       & \vdots       & \ddots            & \vdots & \vdots\\
             \vec{a}_{m1} & \vec{a}_{m2} & \vec{a}_{m3}      & \cdots & \vec{a}_{mn}      & c_{m}
           \end{array}\right)
  \end{align*}
\end{frame}

\begin{frame}[label={sec:orgheadline36}]{Lazy Modulus Switching}
\begin{itemize}
\item Create elimination tables which only eliminate the most significant bits
\item As a consequence columns are not reduced to zero but to small entries.
\item This can be seen as a lazy variant of modulus switching.\footfullcite{PKC:AFFP14}

\item<2-> When eliminating higher order bits in columns with bigger indices, the noise of already reduced columns grows back.
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline37}]{Uneven Noise Contribution}
\begin{center}
\begin{tikzpicture}[scale=0.6,every node/.style={scale=0.6}]
\node (a1) at (0,0) {$(-1, -9 | \phantom{-}7, -9 | -1, \phantom{-}6) \quad -  \quad (-2, -9 | -5, \phantom{-}9 | -5,-4)$};
\node[below of=a1] (e1) {$=$};
\node[below of=e1] (a2)  {$(\alert{\phantom{-}1, \phantom{-}0}| -7,\phantom{-}1|\phantom{-}4,-9)$};

\node (a3) at (10,0) {$(\phantom{-}3, -1|\phantom{-} 0, \phantom{-}0| \phantom{-}2, \phantom{-}6) \quad -  \quad (\phantom{-}4,6|-2,\phantom{-}7| -4, -9)$};
\node[below of=a3] (e3) {$=$};
\node[below of=e3] (a4)  {$(\alert{-1,\phantom{-}1}|-6,\phantom{-}2|\phantom{-}6,-\phantom{-}4)$};

\node at ($(a1)!0.5!(a3)$) {\phantom{(},\phantom{)}};

\node (m1) at ($(a4)!0.5!(a2)$) {$-$};
\node[below of=m1] (e5) {$=$};
\node[below of=e5] (a5) {$(\alert{\phantom{-}2,-1|-1,-1}|\phantom{-}2,\phantom{-}5) $};
\end{tikzpicture}
\end{center}
\end{frame}

\begin{frame}[label={sec:orgheadline38}]{Balancing Noise}
\begin{itemize}
\item \alert{Pick decreasing moduli} (increasing noise levels) for consecutive blocks to address this problem.
\item Complexity now dominated by the size of the first table for eliminating first components.
\item To compensate for this, \alert{choose increasing blocksizes} \(b_i\) for each block. \footfullcite{C:KirFou15}
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline39}]{Coded-BKW}
This approach can be generalised

\begin{itemize}
\item Consider modulus switching as a special form of quantisation (also done in \cite{C:KirFou15})
\item Choose appropriate \alert{lattice code} to find good quantisation
\item Consider blocks of size \(b_i\) as messages which are thrown into buckets based on the codeword they correspond to.\footfullcite{C:GuoJohSta15}
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline40}]{Coded-BKW}
\begin{center}
\begin{tikzpicture}[scale=0.95]
  \begin{axis}[
    legend pos=outer north east,
    axis lines=middle,
    xmin=0, xmax=4,
    ymin=50, ymax=360,
    axis y line*=left,
    axis x line*=bottom,
    xticklabels={Dual, Decode, Embed, BKW},
    xtick={1,...,4},
    ytick={100, 137.4, 174.7, 359.9},
    x tick label style={rotate=45,anchor=east},
    legend columns=1,
    legend cell align=left,]

    \addplot [only marks,color=skyblue1] table [x=idx,y=base/sieve,col sep=comma] {times.csv};
    \addplot [only marks,color=chocolate1,] table [x=idx,y=base/lp,col sep=comma] {times.csv};

    \addplot [only marks,color=scarletred1,table/row sep=\\] table {
      4 359.9\\
    };
    \legend{lp,sieving,bkw}\;
    \addplot[color=lightgray,table/row sep=\\] table {
      0 137.4\\
      4 137.4\\
    };
    \addplot[color=lightgray,table/row sep=\\] table {
      0 174.7\\
      4 174.7\\
    };

  \end{axis}
\end{tikzpicture}
\end{center}

\begin{center}
Plain BKW costs \alert{\(2^{1310.4}\)} bit operations.
\end{center}
\end{frame}

\begin{frame}[label={sec:orgheadline41}]{Modulus Switching for Dual Attack}
\begin{itemize}
\item Lazy modulus switching proceeds from the observation that we do not need to find \(\vec{v} ⋅ \vec{A} ≡ 0 \bmod q\), but any short enough \(\vec{v} ⋅ \vec{A}\) suffices.
\item Consider the dual attack lattice for the LWE normal form \[Λ(\vec{A}) = \{(\vec{x},\vec{y}) \in \ZZ^m × \ZZ^n : \vec{x}⋅ \vec{A} ≡ \vec{y} \bmod q\} \]
\item Given a short vector \(\vec{v} = (\vec{v}',\vec{w}') \in Λ(\vec{A})\) compute \[\vec{v'}⋅\vec{c} = \vec{v'}⋅(\vec{A}⋅\vec{s} + \vec{e}) = \ip{\vec{w}'}{\vec{s}} + \ip{\vec{v}'}{\vec{e}} \]
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline42}]{Modulus Switching for Dual Attack}
\begin{itemize}
\item Aim is to balance \(\|\ip{\vec{w}'}{\vec{s}}\| ≈ \|\ip{\vec{v}'}{\vec{e}}\|\) when \(\|\vec{s}\|\) is small.

\item Similar to the Bai-Gail algorithm, consider the scaled dual attack lattice \[Λ(\vec{A}) = \{(\vec{x}, \vec{y}/c) \in \ZZ^m × {({1}/{c} ⋅ \ZZ)}^n : \vec{x} ⋅ \vec{A} ≡ \vec{y} \bmod q\} \] for some constant \(c\).

\item Lattice reduction produces a vector \((\vec{v}',\vec{w}')\) with \[\|(\vec{v}',\vec{w}')\| ≈ δ_0^{(m+n)}⋅ {(q/c)}^{n/(m+n)}.\]

\item The final error we aim to distinguish from uniform is
\end{itemize}
\[e = \vec{v}' ⋅ \vec{A} ⋅ \vec{s} + \ip{\vec{v}'}{\vec{e}}  = \ip{c⋅ \vec{w}'}{\vec{s}} + \ip{\vec{v}'}{\vec{e}}.\]
\end{frame}

\begin{frame}[label={sec:orgheadline43}]{Modulus Switching for Dual Attack}
From \[e = \vec{v}' ⋅ \vec{A} ⋅ \vec{s} + \ip{\vec{v}'}{\vec{e}}  = \ip{c⋅ \vec{w}'}{\vec{s}} + \ip{\vec{v}'}{\vec{e}}.\] we find \(c\) by solving \[\sqrt{h}\,c = \frac{α\,q}{\sqrt{2\,\pi}} ⋅ \sqrt{m - n}\] which equalises the noise contributions of both parts of the sum.
\end{frame}

\begin{frame}[label={sec:orgheadline44}]{Modulus Switching for Dual Attack}
\begin{lemma}
Let \alert{\(m=2\,n\)} and \(c = \frac{α\,q}{\sqrt{2\,\pi\,h}} ⋅ \sqrt{m - n}\). A lattice reduction algorithm achieving \(δ_0\) such that 

\[\log δ_0 = \frac{\log\left(\frac{\sqrt{8\,π}\, (\log(ε)/π)\, \sqrt{n}}{\left(2 \, π + 1\right)\, α
\sqrt{h}}\right)}{4 \, n}\]

leads to an algorithm solving decisional LWE with \(\vec{s} \sample \B[64]{-}\) instance with advantage \(ε\) and the same cost.
\end{lemma}
\end{frame}

\begin{frame}[label={sec:orgheadline45}]{Modulus Switching: Sieving}
\begin{center}
\begin{tikzpicture}[scale=0.95]
  \begin{axis}[
    legend pos=outer north east,
    axis lines=middle,
    xmin=0.5, xmax=3.5,
    ymin=120, ymax=150,
    axis y line*=left,
    axis x line*=bottom,
    xticklabels={Dual, Decode, Kannan},
    xtick={1,...,3},
    ytick={120, 127.3, 150},
    x tick label style={rotate=45,anchor=east},
    legend columns=1,
    legend cell align=left,]
    \addplot [only marks,color=skyblue1!40!white] table [x=idx,y=base/sieve,col sep=comma] {times.csv};
    \addplot [only marks,color=skyblue1,table/row sep=\\] table {
      1 127.3\\
      2 138.7\\
      3 140.1\\
    };
    \legend{base line, mod switch}\;
    \addplot[color=lightgray,table/row sep=\\] table {
      0.5 127.3\\
      3.5 127.3\\
    };
  \end{axis}
\end{tikzpicture}
\end{center}
\end{frame}

\section{Sparse Secrets}
\label{sec:orgheadline57}
\begin{frame}[label={sec:orgheadline47}]{Exploiting Sparse Secrets}
Approaches so far exploit \alert{small} secrets, but in HELib the secret is \alert{sparse}, i.e. most components are zero.
\end{frame}

\begin{frame}[label={sec:orgheadline48}]{\(\ZZ_q^n ≈ \ZZ_{q^2}^{n/2} ≈ \ZZ_{q^n}\)}
LWE in dimension \(n\) and with modulus \(q\) is equivalent to LWE in dimension \(n/k\) and modulus \(q^{k}\).\footfullcite{STOC:BLPRS13}

Let \(n=2\), \(A = \vec{a}_0 ⋅ q + \vec{a}_1 \pmod{q^2}\) and \(S = \vec{s}_0  + \vec{s}_1 ⋅ q \pmod{q^2}\).

\begin{align*}
A ⋅ S &= (\vec{a}_0 ⋅ q + \vec{a}_1) ⋅ (\vec{s}_0  + \vec{s}_1 ⋅ q) & \pmod{q^2}\\
     &= \vec{a}_0 ⋅ q ⋅ \vec{s}_0 + \vec{a}_1 ⋅ \vec{s}_0  + \vec{a}_0 ⋅ q ⋅ \vec{s}_1 ⋅ q + \vec{a}_1 ⋅ \vec{s}_1 ⋅ q  & \pmod{q^2}\\
     &= (\vec{a}_0 ⋅ \vec{s}_0 + \vec{a}_1 ⋅ \vec{s}_1) ⋅ q + \vec{a}_0 ⋅ \vec{s}_1 ⋅ q^2 + \vec{a}_1 ⋅ \vec{s}_0  & \pmod{q^2}\\
     &≈ (\ip{\vec{a}}{\vec{s}}\pmod{q}) ⋅ q & \pmod{q^2}
\end{align*}
\end{frame}

\begin{frame}[label={sec:orgheadline49}]{\(\ZZ_q^n ≈ \ZZ_{q^2}^{n/2} ≈ \ZZ_{q^n}\) for Sparse Secrets}
\begin{itemize}
\item Transform instance in dimension \(n\) to instance in dimension \(n/2\) and with modulus \(q^2\).
\item The new secret is \(\vec{S}_i = \vec{s}_{2i+0}  + \vec{s}_{2i+1} ⋅ q \pmod{q^2}\) for \(0≤ i < n/2\) where \(\vec{s}_{2i+1} = 0\) with good probability.
\item When this condition holds for all \(\vec{S}_i\), the secret is shorter than the noise by a factor of \(≈q\).
\item Apply your favourite small secret solving strategy.
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline50}]{Ignoring Components}
\begin{itemize}
\item When the secret is sparse, most columns of \(\vec{A}\) are irrelevant.

\item In our example, the probability that a random coordinate is non-zero is \[64/2048 = 1/32.\]

\item Ignoring \(k\) random components in dimension \(n\) for an instance with \(h\) nonzero components will ignore only zero components with probability \[P_{k} = \prod_{i=0}^{k-1} \left(   1- \frac{h} {n-i} \right) = \frac{\binom{n-h}{k}}{\binom{n}{k}} \]

\item Solving \(≈1/P_{k}\) instances in dimension \(n-k\) with sufficiently high advantage solves our instance at dimension \(n\).
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline51}]{Ignoring Components in Dual Attack}
\begin{center}
\scriptsize
\begin{align*}
0 \phantom{xxi} &\stackrel{?}{=} \overset{\vec{v}}{\begin{pmatrix}
v_0\\
v_1\\
v_2\\
\vdots\\
v_{m-3}\\
v_{m-2}\\
v_{m-1}\\
\end{pmatrix}} \cdot 
\overset{\vec{A}}{
\left(\begin{array}{ccc|ccc} 
a_{0,0} & \cdots & a_{0,k-1} & a_{0,k} & \cdots & a_{0,n-1}\\
a_{1,0} & \cdots & a_{1,k-1} & a_{1,k} & \cdots & a_{1,n-1}\\
a_{2,0} & \cdots & a_{2,k-1} & a_{2,k} & \cdots & a_{2,n-1}\\
\vdots  & \ddots & \vdots & \vdots & \ddots & \vdots\\
a_{m-3,0} & \cdots & a_{m-3,k-1} & a_{m-3,k} & \cdots & a_{m-3,n-1}\\
a_{m-2,0} & \cdots & a_{m-2,k-1} & a_{m-2,k} & \cdots & a_{m-2,n-1}\\
a_{m-1,0} & \cdots & a_{m-1,k-1} & a_{m-1,k} & \cdots & a_{m-1,n-1}\\
\end{array}\right)} \cdot 
\overset{\vec{s}}{\begin{pmatrix}s_0\\ \vdots\\ s_{k-1}\\ \hline s_k\\ \vdots\\ s_{n-1}\\ \end{pmatrix}}\\
&\stackrel{?}{=} \phantom{\begin{pmatrix}v_m-3\end{pmatrix} \cdot\ } \left(\begin{array}{ccc|ccc} 
\phantom{xxx} a'_{0,0} \phantom{x} & \cdots & \phantom{x} a'_{0,k-1} \phantom{xi} & \phantom{xxx} 0 \phantom{xxi} & \cdots & \phantom{xxxx} 0 \phantom{xxxx}\\
\end{array}\right) \phantom{i} \cdot {\begin{pmatrix}s_0\\ \vdots\\ s_{k-1}\\ \hline s_k\\ \vdots\\ s_{n-1}\\ \end{pmatrix}}\\
\end{align*}
\end{center}
\end{frame}

\begin{frame}[label={sec:orgheadline52}]{Ignoring Components in Dual Attack}
\begin{center}
\scriptsize
\begin{align*}
0 \phantom{xxi} &= \overset{\vec{v}}{\begin{pmatrix}
v_0\\
v_1\\
v_2\\
\vdots\\
v_{m-3}\\
v_{m-2}\\
v_{m-1}\\
\end{pmatrix}} \cdot 
\overset{\vec{A}}{
\left(\begin{array}{ccc|ccc} 
a_{0,0} & \cdots & a_{0,k-1} & a_{0,k} & \cdots & a_{0,n-1}\\
a_{1,0} & \cdots & a_{1,k-1} & a_{1,k} & \cdots & a_{1,n-1}\\
a_{2,0} & \cdots & a_{2,k-1} & a_{2,k} & \cdots & a_{2,n-1}\\
\vdots  & \ddots & \vdots & \vdots & \ddots & \vdots\\
a_{m-3,0} & \cdots & a_{m-3,k-1} & a_{m-3,k} & \cdots & a_{m-3,n-1}\\
a_{m-2,0} & \cdots & a_{m-2,k-1} & a_{m-2,k} & \cdots & a_{m-2,n-1}\\
a_{m-1,0} & \cdots & a_{m-1,k-1} & a_{m-1,k} & \cdots & a_{m-1,n-1}\\
\end{array}\right)} \cdot 
\overset{\vec{s}}{\begin{pmatrix}0\\ \vdots\\ 0\\ \hline s_k\\ \vdots\\ s_{n-1}\\ \end{pmatrix}}\\
&= \phantom{\begin{pmatrix}v_m-3\end{pmatrix} \cdot\ } \left(\begin{array}{ccc|ccc} 
\phantom{xxx} a'_{0,0} \phantom{x} & \cdots & \phantom{x} a'_{0,k-1} \phantom{xi} & \phantom{xxx} 0 \phantom{xxi} & \cdots & \phantom{xxxx} 0 \phantom{xxxx}\\
\end{array}\right) \phantom{i} \cdot {\begin{pmatrix}0\\ \vdots\\ 0\\ \hline s_k\\ \vdots\\ s_{n-1}\\ \end{pmatrix}}\\
\end{align*}
\end{center}
\end{frame}

\begin{frame}[label={sec:orgheadline53}]{Dual Attack}
\includegraphics[width=1.0\textwidth]{sparse.png}


\begin{center}
Solving \(1/P_k\) instances with \(n=2048-k\), \(α≈2^{-60.4}\) and \(q≈2^{63.4}\).
\end{center}
\end{frame}

\begin{frame}[label={sec:orgheadline54}]{Postprocessing}
\begin{center}
\scriptsize
\begin{align*}
\alert{a'_{0,0}} &= \overset{\vec{v}}{\begin{pmatrix}
v_0\\
v_1\\
v_2\\
\vdots\\
v_{m-3}\\
v_{m-2}\\
v_{m-1}\\
\end{pmatrix}} \cdot 
\overset{\vec{A}}{
\left(\begin{array}{ccc|ccc} 
a_{0,0} & \cdots & a_{0,k-1} & a_{0,k} & \cdots & a_{0,n-1}\\
a_{1,0} & \cdots & a_{1,k-1} & a_{1,k} & \cdots & a_{1,n-1}\\
a_{2,0} & \cdots & a_{2,k-1} & a_{2,k} & \cdots & a_{2,n-1}\\
\vdots  & \ddots & \vdots & \vdots & \ddots & \vdots\\
a_{m-3,0} & \cdots & a_{m-3,k-1} & a_{m-3,k} & \cdots & a_{m-3,n-1}\\
a_{m-2,0} & \cdots & a_{m-2,k-1} & a_{m-2,k} & \cdots & a_{m-2,n-1}\\
a_{m-1,0} & \cdots & a_{m-1,k-1} & a_{m-1,k} & \cdots & a_{m-1,n-1}\\
\end{array}\right)} \cdot 
\overset{\vec{s}}{\begin{pmatrix}\alert{1}\\ \vdots\\ 0\\ \hline s_k\\ \vdots\\ s_{n-1}\\ \end{pmatrix}}\\
&= \phantom{\begin{pmatrix}v_m-3\end{pmatrix} \cdot\ } \left(\begin{array}{ccc|ccc} 
\phantom{xxx} \alert{a'_{0,0}} \phantom{x} & \cdots & \phantom{x} a'_{0,k-1} \phantom{xi} & \phantom{xxx} 0 \phantom{xxi} & \cdots & \phantom{xxxx} 0 \phantom{xxxx}\\
\end{array}\right) \phantom{i} \cdot {\begin{pmatrix}\alert{1}\\ \vdots\\ 0\\ \hline s_k\\ \vdots\\ s_{n-1}\\ \end{pmatrix}}\\
\end{align*}
\end{center}
\end{frame}

\begin{frame}[label={sec:orgheadline55}]{Postprocessing}
The probability to drop \(k-j\) columns with \(s_i=0\) and exactly \(j\) components with \(s_i ≠ 0\) is \[P_{k,j} =  \frac {{\binom{n-h}{k-j}}{\binom{h}{j}}}{\binom{n}{k}}\]

\begin{itemize}
\item Repeat experiment \({\left({\sum_{j=0}^{ℓ} P_{k,j}}\right)}^{-1}\) times

\item Perform \(\sum_{i=0}^{ℓ} \binom{k}{i} ⋅ 2^i\) checks against uniform distribution, reusing short vector output by lattice reduction.
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgheadline56}]{Ignoring Components}
\begin{center}
\begin{tikzpicture}[scale=0.95]
  \begin{axis}[
    legend pos=outer north east,
    axis lines=middle,
    xmin=0.5, xmax=3.5,
    ymin=50, ymax=190,
    axis y line*=left,
    axis x line*=bottom,
    xticklabels={Dual, Decode, Embed},
    xtick={1,...,3},
    ytick={104.4, 150},
    x tick label style={rotate=45,anchor=east},
    legend columns=1,
    legend cell align=left,]

    \addplot [only marks,color=chocolate1] table [x=idx,y=sparse/lp,col sep=comma] {times.csv};
    \addplot [only marks,color=skyblue1] table [x=idx,y=sparse/sieve,col sep=comma] {times.csv};

    \legend{lp,sieving}\;
 
    \addplot [only marks,color=skyblue1!40!white] table [x=idx,y=base/sieve,col sep=comma] {times.csv};
    \addplot [only marks,color=chocolate1!40!white] table [x=idx,y=base/lp,col sep=comma] {times.csv};
 
   \addplot[color=lightgray,table/row sep=\\] table {
      0.5 104.4\\
      3.5 104.4\\
    };

  \end{axis}
\end{tikzpicture}
\end{center}
\end{frame}

\section{Results}
\label{sec:orgheadline60}

\begin{frame}[label={sec:orgheadline58}]{Results}
\begin{center}
\begin{tabular}{rr|rrrrrr}
 & Strategy & Dual &  & Dec &  & Embed & \\
 &  & sieve & lp & sieve & lp & sieve & lp\\
\hline
0 & base line & 145.6 & 188.9 & 137.4 & 174.7 & 138.8 & 178.6\\
1 & secret ↔ & 143.3 & 185.2 & 135.0 & 171.6 & 134.8 & 171.9\\
2 & modulus ↔ & 127.4 & 159.5 & 138.7 & 177.4 & 140.1 & 180.9\\
3 & drop & 107.3 & 104.1 & 126.1 & 113.5 & 127.3 & 111.5\\
\hline
4 & ++ & 96.8 & 92.9 & 125.4 & 113.2 & 127.3 & 111.5\\
\end{tabular}

\end{center}


After dropping some components the resulting instance still has a sparse and small secret → combine strategies: “++“.
\end{frame}

\begin{frame}[label={sec:orgheadline59}]{Thank you}
\begin{center}
\includegraphics[width=.9\linewidth]{./kitten-01.jpg}

\alert{\Large Questions?}
\end{center}
\end{frame}
\end{document}